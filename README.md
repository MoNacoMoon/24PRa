using System;

public class Program
{
    // --- Классы синхронного автомата ---

    // Класс, представляющий синхронный автомат
    public class SynchronousAutomaton
    {
        // Перечисление для возможных состояний автомата
        public enum State
        {
            A,
            B
        }

        // Свойство для хранения текущего состояния автомата
        public State CurrentState { get; private set; }

        // Конструктор: инициализирует автомат начальным состоянием 'A'
        public SynchronousAutomaton()
        {
            CurrentState = State.A; // Предполагаем, что 'A' - начальное состояние
        }

        /// <summary>
        /// Обрабатывает входной сигнал, обновляет состояние автомата и возвращает выходной сигнал.
        /// </summary>
        /// <param name="input">Входной сигнал (0, 1 или 2).</param>
        /// <returns>Выходной сигнал.</returns>
        /// <exception cref="ArgumentException">Выбрасывается, если входной сигнал недопустим.</exception>
        /// <exception cref="InvalidOperationException">Выбрасывается при неизвестном текущем состоянии (в случае логической ошибки).</exception>
        public int ProcessInput(int input)
        {
            int output; // Переменная для хранения выходного сигнала

            // Использование оператора switch для обработки текущего состояния
            switch (CurrentState)
            {
                case State.A:
                    // Обработка переходов из состояния 'A'
                    switch (input)
                    {
                        case 0:
                            CurrentState = State.B; // Переход в 'B'
                            output = 2;              // Выход 2
                            break;
                        case 1:
                            CurrentState = State.A; // Остается в 'A'
                            output = 2;              // Выход 2
                            break;
                        case 2:
                            CurrentState = State.B; // Переход в 'B'
                            output = 1;              // Выход 1
                            break;
                        default:
                            throw new ArgumentException($"Недопустимый вход '{input}' для состояния A.");
                    }
                    break;

                case State.B:
                    // Обработка переходов из состояния 'B'
                    switch (input)
                    {
                        case 0:
                            CurrentState = State.A; // Переход в 'A'
                            output = 1;              // Выход 1
                            break;
                        case 1:
                            CurrentState = State.B; // Остается в 'B'
                            output = 0;              // Выход 0
                            break;
                        case 2:
                            CurrentState = State.A; // Переход в 'A'
                            output = 2;              // Выход 2
                            break;
                        default:
                            throw new ArgumentException($"Недопустимый вход '{input}' для состояния B.");
                    }
                    break;

                default:
                    // Это не должно произойти, если логика состояний корректна
                    throw new InvalidOperationException("Неизвестное текущее состояние автомата.");
            }
            return output;
        }
    }

    // --- Классы прямоугольников ---

    // Родительский класс: Прямоугольник
    public class Прямоугольник
    {
        public int X1 { get; set; }
        public int Y1 { get; set; }
        public int X2 { get; set; }
        public int Y2 { get; set; }

        // Конструктор по умолчанию
        public Прямоугольник()
        {
            X1 = 0;
            Y1 = 0;
            X2 = 0;
            Y2 = 0;
        }

        // Параметризованный конструктор
        public Прямоугольник(int x1, int y1, int x2, int y2)
        {
            // Проверка на корректность координат
            if (x1 >= x2 || y1 >= y2)
            {
                throw new ArgumentException("Неверные координаты прямоугольника: X1 должен быть меньше X2, а Y1 должен быть меньше Y2.");
            }
            X1 = x1;
            Y1 = y1;
            X2 = x2;
            Y2 = y2;
        }

        // Метод для вычисления ширины
        public int Ширина => Math.Abs(X2 - X1);

        // Метод для вычисления высоты
        public int Высота => Math.Abs(Y2 - Y1);

        // Метод для вычисления периметра
        public virtual double ВычислитьПериметр()
        {
            return 2 * (Ширина + Высота);
        }

        // Метод для вычисления длины диагонали
        public virtual double ВычислитьДлинуДиагонали()
        {
            return Math.Sqrt(Math.Pow(Ширина, 2) + Math.Pow(Высота, 2));
        }

        // Метод для формирования строки информации об объекте
        public virtual string ПолучитьИнформацию()
        {
            return $"Координаты прямоугольника: ({X1}, {Y1}) до ({X2}, {Y2})\n" +
                   $"Ширина: {Ширина}, Высота: {Высота}\n" +
                   $"Периметр: {ВычислитьПериметр():F2}, Длина диагонали: {ВычислитьДлинуДиагонали():F2}";
        }
    }

    // Дочерний класс: ЗакрашенныйПрямоугольникСТекстом
    public class ЗакрашенныйПрямоугольникСТекстом : Прямоугольник
    {
        public string Текст { get; set; }
        public string ЦветЗаливки { get; set; }

        // Конструктор
        public ЗакрашенныйПрямоугольникСТекстом(int x1, int y1, int x2, int y2, string текст, string цветЗаливки)
            : base(x1, y1, x2, y2) // Вызов конструктора базового класса
        {
            Текст = текст;
            ЦветЗаливки = цветЗаливки;
        }

        // Функция обработки данных: Произведение периметра и длины диагонали
        public double ВычислитьПроизведениеПериметраИДиагонали()
        {
            double периметр = ВычислитьПериметр();
            double диагональ = ВычислитьДлинуДиагонали();
            return периметр * диагональ;
        }

        // Переопределение метода ПолучитьИнформацию для включения информации, специфичной для дочернего класса
        public override string ПолучитьИнформацию()
        {
            return base.ПолучитьИнформацию() +
                   $"\nТекст: {Текст}\n" +
                   $"Цвет заливки: {ЦветЗаливки}\n" +
                   $"Произведение периметра и диагонали: {ВычислитьПроизведениеПериметраИДиагонали():F2}";
        }
    }

    // --- Классы спортсменов ---

    // Класс 1: Спортсмен (Базовый класс)
    // Представляет спортсмена с его фамилией, числом соревнований и суммой занятых мест.
    // Рассчитывает базовое "качество" Q.
    public class Спортсмен
    {
        // Поля класса
        public string Фамилия { get; set; }
        public int ЧислоСоревнований { get; set; }
        public int СуммаМест { get; set; }

        // Конструктор
        public Спортсмен(string фамилия, int числоСоревнований, int суммаМест)
        {
            Фамилия = фамилия;
            ЧислоСоревнований = числоСоревнований;
            СуммаМест = суммаМест;
        }

        // Функция для определения "качества" объекта - Q
        // Формула: Q = (число соревнований) / (сумма мест)
        public virtual double ОпределитьКачествоQ()
        {
            if (СуммаМест == 0)
            {
                return 0; // Избегаем деления на ноль, если сумма мест равна 0.
                          // В реальных сценариях можно рассмотреть бросание исключения или другое поведение.
            }
            return (double)ЧислоСоревнований / СуммаМест;
        }

        // Вывод информации об объекте
        public virtual void ВывестиИнформацию()
        {
            Console.WriteLine($"--- Информация о спортсмене ---");
            Console.WriteLine($"Фамилия: {Фамилия}");
            Console.WriteLine($"Число соревнований: {ЧислоСоревнований}");
            Console.WriteLine($"Сумма мест: {СуммаМест}");
            // Используем форматирование ":F2" для вывода числа с двумя знаками после запятой
            Console.WriteLine($"Качество (Q): {ОпределитьКачествоQ():F2}");
        }
    }

    // Класс 2: ЧемпионСпортсмен (Класс-потомок)
    // Наследуется от Спортсмен.
    // Добавляет новое поле P (занимал ли хотя бы раз первое место).
    // Переопределяет метод ОпределитьКачествоQ для расчета Qp по новой формуле.
    public class ЧемпионСпортсмен : Спортсмен
    {
        // Дополнительное поле P
        public bool ЗанималПервоеМесто { get; set; } // P: занимал ли хотя бы раз первое место

        // Конструктор для ЧемпионСпортсмен
        public ЧемпионСпортсмен(string фамилия, int числоСоревнований, int суммаМест, bool занималПервоеМесто)
            : base(фамилия, числоСоревнований, суммаМест) // Вызываем конструктор базового класса
        {
            ЗанималПервоеМесто = занималПервоеМесто;
        }

        // Переопределение функции определения качества для Qp
        // Формула: Qp = 1.5 * Q, если P - истина, иначе Qp = Q
        public override double ОпределитьКачествоQ()
        {
            double базовоеКачествоQ = base.ОпределитьКачествоQ(); // Получаем Q из базового класса

            if (ЗанималПервоеМесто) // Если P истинно
            {
                return 1.5 * базовоеКачествоQ;
            }
            else // Иначе (P ложно)
            {
                return базовоеКачествоQ;
            }
        }

        // Переопределение метода вывода информации, чтобы включить P и Qp
        public override void ВывестиИнформацию()
        {
            Console.WriteLine($"\n--- Информация о спортсмене-чемпионе ---");
            Console.WriteLine($"Фамилия: {Фамилия}");
            Console.WriteLine($"Число соревнований: {ЧислоСоревнований}");
            Console.WriteLine($"Сумма мест: {СуммаМест}");
            Console.WriteLine($"Занимал ли первое место (P): {ЗанималПервоеМесто}");
            // Этот вызов ОпределитьКачествоQ() теперь будет использовать переопределенную версию,
            // которая вычисляет Qp.
            Console.WriteLine($"Качество (Qp): {ОпределитьКачествоQ():F2}");
        }
    }

    // --- Основная логика программы ---

    public static void Main(string[] args)
    {
        Console.OutputEncoding = System.Text.Encoding.UTF8; // Для корректного отображения кириллицы в консоли

        while (true)
        {
            Console.WriteLine("\n--- Выберите программу для запуска ---");
            Console.WriteLine("1. Синхронный автомат");
            Console.WriteLine("2. Работа с прямоугольниками (Наследование)");
            Console.WriteLine("3. Информация о спортсменах (Наследование и Полиморфизм)");
            Console.WriteLine("0. Выход");
            Console.Write("Ваш выбор: ");

            string choice = Console.ReadLine();

            switch (choice)
            {
                case "1":
                    RunSynchronousAutomatonProgram();
                    break;
                case "2":
                    RunRectangleProgram();
                    break;
                case "3":
                    RunAthleteProgram();
                    break;
                case "0":
                    Console.WriteLine("Выход из программы.");
                    return;
                default:
                    Console.WriteLine("Неверный выбор. Пожалуйста, попробуйте снова.");
                    break;
            }
        }
    }

    // --- Методы, специфичные для программ ---

    public static void RunSynchronousAutomatonProgram()
    {
        Console.Clear();
        Console.WriteLine("--- Запуск программы 'Синхронный автомат' ---");

        // Создаем экземпляр автомата
        SynchronousAutomaton automaton = new SynchronousAutomaton();

        Console.WriteLine($"Начальное состояние автомата: {automaton.CurrentState}");
        Console.WriteLine("Введите последовательность входных данных (0, 1 или 2).");
        Console.WriteLine("Для завершения введите любое другое число или пустую строку.");

        string inputLine;
        while (true)
        {
            Console.Write("\nВведите вход (0, 1, 2): ");
            inputLine = Console.ReadLine();

            // Проверяем, является ли ввод числом и находится ли он в допустимом диапазоне
            if (int.TryParse(inputLine, out int input) && (input >= 0 && input <= 2))
            {
                try
                {
                    // Обрабатываем вход и получаем выходной сигнал
                    int output = automaton.ProcessInput(input);
                    // Выводим текущее состояние и выход
                    Console.WriteLine($"   Обработан вход: {input}");
                    Console.WriteLine($"   Текущее состояние: {automaton.CurrentState}, Выход: {output}");
                }
                catch (ArgumentException ex)
                {
                    Console.WriteLine($"Ошибка: {ex.Message}");
                }
            }
            else
            {
                // Завершаем цикл, если введенное значение некорректно
                Console.WriteLine("Недопустимый ввод или команда завершения. Возврат в главное меню.");
                break;
            }
        }
        Console.WriteLine("\nНажмите любую клавишу для продолжения...");
        Console.ReadKey();
    }

    public static void RunRectangleProgram()
    {
        Console.Clear();
        Console.WriteLine("--- Запуск программы 'Работа с прямоугольниками' ---");

        Console.WriteLine("--- Демонстрация Прямоугольника (Родительский класс) ---");
        try
        {
            Прямоугольник прямоугольник1 = new Прямоугольник(10, 20, 50, 60);
            Console.WriteLine(прямоугольник1.ПолучитьИнформацию());
        }
        catch (ArgumentException ex)
        {
            Console.WriteLine($"Ошибка при создании Прямоугольника: {ex.Message}");
        }

        Console.WriteLine("\n--- Демонстрация ЗакрашенногоПрямоугольникаСТекстом (Дочерний класс) ---");
        try
        {
            ЗакрашенныйПрямоугольникСТекстом текстовыйПрямоугольник1 = new ЗакрашенныйПрямоугольникСТекстом(100, 150, 300, 400, "Привет, мир!", "Синий");
            Console.WriteLine(текстовыйПрямоугольник1.ПолучитьИнформацию());
        }
        catch (ArgumentException ex)
        {
            Console.WriteLine($"Ошибка при создании ЗакрашенногоПрямоугольникаСТекстом: {ex.Message}");
        }

        Console.WriteLine("\n--- Демонстрация неверных координат ---");
        try
        {
            Прямоугольник неверныйПрямоугольник = new Прямоугольник(50, 60, 10, 20); // Неверно: X1 > X2
            Console.WriteLine(неверныйПрямоугольник.ПолучитьИнформацию());
        }
        catch (ArgumentException ex)
        {
            Console.WriteLine($"Перехвачена ошибка: {ex.Message}");
        }

        Console.WriteLine("\nНажмите любую клавишу для продолжения...");
        Console.ReadKey();
    }

    public static void RunAthleteProgram()
    {
        Console.Clear();
        Console.WriteLine("--- Запуск программы 'Информация о спортсменах' ---");

        Console.WriteLine("------------------------------------------");
        Console.WriteLine("       Демонстрация классов 'Спортсмен' и 'ЧемпионСпортсмен'");
        Console.WriteLine("------------------------------------------\n");

        // Демонстрация Класса 1: Спортсмен
        Console.WriteLine("Создание объекта класса 1-го уровня (Спортсмен):");
        Console.Write("Введите фамилию спортсмена: ");
        string фамилияСпортсмена = Console.ReadLine();

        int числоСоревнованийСпортсмена;
        Console.Write("Введите количество соревнований: ");
        // Добавляем проверку ввода для целочисленных значений
        while (!int.TryParse(Console.ReadLine(), out числоСоревнованийСпортсмена) || числоСоревнованийСпортсмена < 0)
        {
            Console.Write("Некорректный ввод. Введите целое положительное число: ");
        }

        int суммаМестСпортсмена;
        Console.Write("Введите сумму занятых мест: ");
        while (!int.TryParse(Console.ReadLine(), out суммаМестСпортсмена) || суммаМестСпортсмена < 0)
        {
            Console.Write("Некорректный ввод. Введите целое положительное число: ");
        }

        Спортсмен спортсмен1 = new Спортсмен(фамилияСпортсмена, числоСоревнованийСпортсмена, суммаМестСпортсмена);
        спортсмен1.ВывестиИнформацию();

        Console.WriteLine("\n------------------------------------------\n");

        // Демонстрация Класса 2: ЧемпионСпортсмен
        Console.WriteLine("Создание объекта класса 2-го уровня (ЧемпионСпортсмен):");
        Console.Write("Введите фамилию спортсмена-чемпиона: ");
        string фамилияЧемпиона = Console.ReadLine();

        int числоСоревнованийЧемпиона;
        Console.Write("Введите количество соревнований: ");
        while (!int.TryParse(Console.ReadLine(), out числоСоревнованийЧемпиона) || числоСоревнованийЧемпиона < 0)
        {
            Console.Write("Некорректный ввод. Введите целое положительное число: ");
        }

        int суммаМестЧемпиона;
        Console.Write("Введите сумму занятых мест: ");
        while (!int.TryParse(Console.ReadLine(), out суммаМестЧемпиона) || суммаМестЧемпиона < 0)
        {
            Console.Write("Некорректный ввод. Введите целое положительное число: ");
        }

        bool чемпионЗанималПервоеМесто;
        Console.Write("Занимал ли спортсмен-чемпион хотя бы раз первое место? (true/false): ");
        // Добавляем проверку ввода для булевых значений
        while (!bool.TryParse(Console.ReadLine(), out чемпионЗанималПервоеМесто))
        {
            Console.Write("Некорректный ввод. Введите 'true' или 'false': ");
        }

        ЧемпионСпортсмен чемпионСпортсмен1 = new ЧемпионСпортсмен(
            фамилияЧемпиона,
            числоСоревнованийЧемпиона,
            суммаМестЧемпиона,
            чемпионЗанималПервоеМесто
        );
        чемпионСпортсмен1.ВывестиИнформацию();

        Console.WriteLine("\n------------------------------------------");
        Console.WriteLine("       Демонстрация полиморфизма (Объект 'ЧемпионСпортсмен' через ссылку 'Спортсмен')");
        Console.WriteLine("------------------------------------------");
        // Здесь мы создаем объект ЧемпионСпортсмен, но присваиваем его переменной типа Спортсмен.
        // Благодаря полиморфизму, при вызове ВывестиИнформацию(), будет вызван переопределенный
        // метод из ЧемпионСпортсмен.
        Спортсмен полиморфныйСпортсмен = new ЧемпионСпортсмен("Майкл Фелпс", 30, 30, true);
        полиморфныйСпортсмен.ВывестиИнформацию();

        Console.WriteLine("\nНажмите любую клавишу для продолжения...");
        Console.ReadKey();
    }
}
